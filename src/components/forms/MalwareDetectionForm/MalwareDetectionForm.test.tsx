import { render, screen } from '@testing-library/react'
import MalwareDetectionForm from './MalwareDetectionForm'

describe('MalwareDetectionForm', () => {
  it('renders profile name input', () => {
    render(<MalwareDetectionForm onSubmit={vi.fn()} />)
    expect(screen.getByLabelText('Profile Name')).toBeInTheDocument()
  })

  it('renders malware scan groups', () => {
    render(<MalwareDetectionForm onSubmit={vi.fn()} />)
    expect(screen.getByText('Netskope File Scanner')).toBeInTheDocument()
    expect(screen.getByText('Allowlist')).toBeInTheDocument()
    expect(screen.getByText('Blocklist')).toBeInTheDocument()
  })

  it('renders save button disabled when empty', () => {
    render(<MalwareDetectionForm onSubmit={vi.fn()} />)
    expect(screen.getByText('Create Profile')).toBeDisabled()
  })
})
